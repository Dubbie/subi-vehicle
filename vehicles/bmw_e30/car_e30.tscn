[gd_scene load_steps=8 format=3 uid="uid://cvparv6gxmfjl"]

[ext_resource type="PackedScene" uid="uid://bmrx0ppni2eb5" path="res://vehicles/_base/base_vehicle.tscn" id="1_0unmn"]
[ext_resource type="Script" uid="uid://hgrcvwrnhy3a" path="res://src/vehicle/tire_models/brush_tire_model.gd" id="2_m4qmp"]
[ext_resource type="PackedScene" uid="uid://bsf1gktlekuse" path="res://vehicles/bmw_e30/assets/e30.glb" id="3_fu083"]

[sub_resource type="Curve" id="Curve_0unmn"]
_limits = [0.0, 226.0, 0.0, 7500.0]
_data = [Vector2(0, 0), 0.0, 0.167556, 0, 0, Vector2(800, 120), 0.0721245, 0.0721245, 0, 0, Vector2(2000, 180), 0.0371514, 0.0371514, 0, 0, Vector2(3000, 210), 0.0209137, 0.0209137, 0, 0, Vector2(4000, 226), 0.00706564, 0.00706564, 0, 0, Vector2(5800, 200), -0.0210123, -0.0210123, 0, 0, Vector2(6500, 180), -0.0272406, -0.0272406, 0, 0, Vector2(7000, 160), -0.0396147, 0.0796988, 0, 0, Vector2(7500, 0), 0.0, 0.0, 0, 0]
point_count = 9

[sub_resource type="Resource" id="Resource_fu083"]
script = ExtResource("2_m4qmp")
peak_longitudinal_mu = 1.15
peak_lateral_mu = 1.1
sliding_longitudinal_mu = 0.85
sliding_lateral_mu = 0.75
peak_lon_slip_ratio = 0.1
peak_lat_slip_angle_deg = 7.0
lon_curve_sharpness = 1.8
lat_curve_sharpness = 2.2
optimal_load = 3800.0
load_sensitivity = 0.25
friction_circle_shape = 1.1
combined_slip_falloff = 0.4
relaxation_length = 0.12
min_relaxation_speed = 1.0
metadata/_custom_type_script = "uid://hgrcvwrnhy3a"

[sub_resource type="Resource" id="Resource_m4qmp"]
script = ExtResource("2_m4qmp")
peak_longitudinal_mu = 1.15
peak_lateral_mu = 1.1
sliding_longitudinal_mu = 0.85
sliding_lateral_mu = 0.75
peak_lon_slip_ratio = 0.1
peak_lat_slip_angle_deg = 7.0
lon_curve_sharpness = 1.8
lat_curve_sharpness = 2.2
optimal_load = 3500.0
load_sensitivity = 0.25
friction_circle_shape = 1.1
combined_slip_falloff = 0.4
relaxation_length = 0.12
min_relaxation_speed = 1.0
metadata/_custom_type_script = "uid://hgrcvwrnhy3a"

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_fu083"]
points = PackedVector3Array(0.404136, 0.305215, -1.59811, 0.388471, 0.214258, -1.44362, 0.382062, 0.216874, -1.79096, 0.398202, 0.292844, -1.68575, 0.401842, 0.304179, -1.64173, 0.371698, 0.370667, -1.75078, 0.377632, 0.370667, -1.64375, 0.37953, 0.370667, -1.60195, 0.379768, 0.370667, -1.59286, 0.380717, 0.370667, -1.55409, 0.392901, 0.350666, -1.16535, 0.40113, 0.323308, -0.387664, 0.3948, 0.241017, -0.51307, 0.370353, 0.151695, -1.14737, 0.354054, 0.106135, -1.14737, 0.348753, 0.106135, -1.41959, 0.387759, 0.208427, -0.527206, 0.369087, 0.134637, -0.190164, 0.360384, 0.106135, -0.680279, 0.370907, 0.216874, -1.9719, 0.37146, 0.249627, -1.9709, 0.365447, 0.249082, -2.03067, 0.356824, 0.350502, -1.99069, 0.353105, 0.370667, -1.99472, 0.355637, 0.370667, -1.96968, 0.337835, 0.422821, -1.96968, 0.311884, 0.52495, -1.60578, 0.375021, 0.3953, -1.1609, 0.385543, 0.370285, -1.16535, 0.320429, 0.522388, -0.783875, 0.400418, 0.323308, -0.362825, 0.386809, 0.241616, -0.218032, 0.382141, 0.211806, -0.205713, -0.348833, 0.106135, -1.41959, 2.98023e-08, 0.158834, -2.00583, 0.11124, 0.159597, -2.00543, 0.19289, 0.161068, -2.00381, 0.238621, 0.162485, -2.00199, 0.319638, 0.144065, -1.79298, 0.311726, 0.163357, -1.97433, 0.365447, 0.216874, -2.03067, 0.379451, 0.211424, -0.1835, 0.366872, 0.211424, -0.0976739, 0.364656, 0.134256, -0.16795, 0.351839, 0.121885, -0.121503, 0.364973, 0.122212, -0.188952, 0.359988, 0.106135, -0.553055, 0.33831, 0.395409, -2.01734, 0.349545, 0.216874, -2.0549, 0.349545, 0.249791, -2.05349, 0.343373, 0.396008, -2.00199, 0.333879, 0.421077, -2.00644, 0.2656, 0.628005, -1.45069, 0.280316, 0.614053, -0.900396, 0.288149, 0.597105, -0.876769, 0.397649, 0.321183, -0.324052, 0.394642, 0.309684, -0.2875, 0.284509, 0.603481, -0.870913, 0.391003, 0.290065, -0.254583, 0.388471, 0.268429, -0.232976, 0.366872, 0.248483, -0.0976739, -0.354133, 0.106135, -1.14737, -0.38855, 0.214258, -1.44362, -0.382141, 0.216874, -1.79096, -0.370986, 0.216874, -1.9719, -0.365526, 0.216874, -2.03067, -0.311805, 0.163357, -1.97433, -0.319717, 0.144065, -1.79298, -0.2387, 0.162485, -2.00199, -0.19297, 0.161068, -2.00381, -0.111319, 0.159597, -2.00543, -0.111478, 0.216874, -2.06904, 2.98023e-08, 0.216874, -2.06944, 0.111399, 0.216874, -2.06904, 0.311568, 0.216874, -2.06561, 0.290839, 0.165047, -2.00199, 0.268607, 0.163848, -2.00199, 0.303973, 0.165483, -1.99897, 0.306504, 0.165483, -1.99634, 0.361887, 0.211424, -0.0853554, 0.346143, 0.121885, -0.110194, 0.360463, 0.121885, -0.166738, -0.360067, 0.106135, -0.553055, 0.336886, 0.121885, -0.0986836, 0.331031, 0.121885, -0.0954525, 0.325176, 0.121885, -0.0924234, 0.306188, 0.121885, -0.0845476, 0.277943, 0.121885, -0.0732388, 0.0713647, 0.121885, -0.0437553, 2.98023e-08, 0.121885, -0.0401204, 0.328737, 0.419878, -2.01714, 0.311568, 0.249954, -2.06662, 0.311647, 0.370885, -2.0446, 0.234032, 0.637106, -1.50683, 0.259271, 0.612364, -1.54156, 0.254286, 0.638414, -1.4517, 0.265521, 0.62855, -1.43575, 0.275569, 0.622937, -0.922408, 0.274936, 0.620375, -0.89454, 0.364181, 0.37628, -0.322234, 0.364261, 0.34696, -0.201876, 0.344085, 0.336224, -0.09727, 0.342424, 0.378242, -0.199655, 0.361887, 0.248483, -0.0853554, -0.370432, 0.151695, -1.14737, -0.360463, 0.106135, -0.680279, -0.404136, 0.305215, -1.59811, -0.369166, 0.134637, -0.190164, -0.387838, 0.208427, -0.527206, -0.394879, 0.241017, -0.51307, -0.398281, 0.292844, -1.68575, -0.371539, 0.249627, -1.9709, -0.365526, 0.249082, -2.03067, -0.349624, 0.216874, -2.0549, -0.306583, 0.165483, -1.99634, -0.304052, 0.165483, -1.99897, -0.290918, 0.165047, -2.00199, -0.268686, 0.163848, -2.00199, -0.311647, 0.216874, -2.06561, -0.111478, 0.249954, -2.06985, -0.311647, 0.249954, -2.06662, 2.98023e-08, 0.249954, -2.07025, 0.111399, 0.249954, -2.06985, 0.336886, 0.211424, -0.0627379, -0.0714438, 0.121885, -0.0437553, -0.278022, 0.121885, -0.0732388, -0.306267, 0.121885, -0.0845476, -0.325255, 0.121885, -0.0924234, -0.33111, 0.121885, -0.0954525, -0.336965, 0.121885, -0.0986836, -0.346222, 0.121885, -0.110194, -0.351918, 0.121885, -0.121503, -0.360542, 0.121885, -0.166738, -0.365052, 0.122212, -0.188952, 0.330319, 0.211424, -0.0603144, 0.306663, 0.211424, -0.0526407, 0.277943, 0.211424, -0.0465825, 0.225487, 0.211424, -0.0356774, 0.191704, 0.211424, -0.0288115, 0.0713647, 0.211424, -0.0110404, 2.98023e-08, 0.211424, -0.00720358, 0.310856, 0.394537, -2.03754, 0.309985, 0.418352, -2.02926, 0.297089, 0.420859, -2.02926, 0.213619, 0.634926, -1.53046, 0.13822, 0.373882, -2.04743, 0.13822, 0.398406, -2.04036, 0.297959, 0.39579, -2.03754, 0.21987, 0.640376, -1.50804, 0.239966, 0.640648, -1.48563, 0.242735, 0.644027, -1.4517, 0.242577, 0.644681, -1.42161, 0.254207, 0.638741, -1.43655, 0.264334, 0.634981, -1.23986, 0.264413, 0.634327, -1.26248, 0.265442, 0.62904, -1.4206, 0.270189, 0.627678, -0.951286, 0.258875, 0.635635, -0.951286, 0.26473, 0.630457, -0.919783, 0.253179, 0.636071, -0.913119, 0.259587, 0.626751, -0.889693, 0.262435, 0.62261, -0.879394, 0.329132, 0.359876, -0.0958564, 0.353342, 0.362601, -0.200665, 0.336648, 0.34805, -0.0966642, 0.33918, 0.333281, -0.0849515, 0.326996, 0.327014, -0.0722291, 0.336886, 0.248483, -0.0627379, -0.401209, 0.323308, -0.387664, -0.392981, 0.350666, -1.16535, -0.380796, 0.370667, -1.55409, -0.379847, 0.370667, -1.59286, -0.37961, 0.370667, -1.60195, -0.377711, 0.370667, -1.64375, -0.371777, 0.370667, -1.75078, -0.401921, 0.304179, -1.64173, -0.364656, 0.134256, -0.16795, -0.366951, 0.211424, -0.0976739, -0.37953, 0.211424, -0.1835, -0.38222, 0.211806, -0.205713, -0.386888, 0.241616, -0.218032, -0.356903, 0.350502, -1.99069, -0.353184, 0.370667, -1.99472, -0.338389, 0.395409, -2.01734, -0.349624, 0.249791, -2.05349, -0.138299, 0.373882, -2.04743, 2.98023e-08, 0.3741, -2.04844, -0.311726, 0.370885, -2.0446, -0.0714438, 0.211424, -0.0110404, -0.191783, 0.211424, -0.0288115, -0.225566, 0.211424, -0.0356774, -0.278022, 0.211424, -0.0465825, -0.306742, 0.211424, -0.0526407, -0.330398, 0.211424, -0.0603144, -0.336965, 0.211424, -0.0627379, -0.361966, 0.211424, -0.0853554, 0.330319, 0.248483, -0.0603144, 0.306663, 0.248483, -0.0526407, 0.277943, 0.248483, -0.0465825, 0.225487, 0.248483, -0.0356774, 0.191704, 0.248483, -0.0288115, 0.0713647, 0.248483, -0.0110404, 2.98023e-08, 0.248483, -0.00720358, 0.191545, 0.425164, -2.03087, 0.157841, 0.639286, -1.53551, 0.196688, 0.636507, -1.53268, 0.202226, 0.642501, -1.50905, 2.98023e-08, 0.399387, -2.04137, 2.98023e-08, 0.428107, -2.03309, 0.138536, 0.426036, -2.03208, 0.207844, 0.646916, -1.48563, 0.22612, 0.643973, -1.48563, 0.228335, 0.647243, -1.4517, 0.228177, 0.647897, -1.42161, 0.241469, 0.648605, -1.24128, 0.252941, 0.642992, -1.24128, 0.247324, 0.641248, -0.951286, 0.238779, 0.639286, -0.908272, 0.315998, 0.364672, -0.0960584, 0.313388, 0.35895, -0.0829321, 0.323436, 0.352464, -0.0825282, 0.319875, 0.334644, -0.0710175, -0.400497, 0.323308, -0.362825, -0.320508, 0.522388, -0.783875, -0.385623, 0.370285, -1.16535, -0.3751, 0.3953, -1.1609, -0.311963, 0.52495, -1.60578, -0.337914, 0.422821, -1.96968, -0.355716, 0.370667, -1.96968, -0.366951, 0.248483, -0.0976739, -0.38855, 0.268429, -0.232976, -0.391082, 0.290065, -0.254583, -0.394721, 0.309684, -0.2875, -0.343452, 0.396008, -2.00199, -0.333958, 0.421077, -2.00644, -0.328816, 0.419878, -2.01714, -0.138299, 0.398406, -2.04036, -0.310935, 0.394537, -2.03754, -0.298039, 0.39579, -2.03754, -0.0714438, 0.248483, -0.0110404, -0.191783, 0.248483, -0.0288115, -0.225566, 0.248483, -0.0356774, -0.278022, 0.248483, -0.0465825, -0.306742, 0.248483, -0.0526407, -0.330398, 0.248483, -0.0603144, -0.336965, 0.248483, -0.0627379, -0.361966, 0.248483, -0.0853554, 0.189963, 0.348486, -0.0451689, 0.312834, 0.339821, -0.0700078, 0.0696241, 0.352355, -0.0273979, 2.98023e-08, 0.354808, -0.023561, 0.0958123, 0.640866, -1.53854, 0.10143, 0.647297, -1.51208, 0.163775, 0.645117, -1.51067, 0.169709, 0.650349, -1.48563, -0.138615, 0.426036, -2.03208, 2.98023e-08, 0.643101, -1.53854, 0.172557, 0.654273, -1.4517, 0.211404, 0.650294, -1.4517, 0.211088, 0.651439, -1.40061, 0.22699, 0.65182, -1.24128, 0.232924, 0.644463, -0.951286, 0.221848, 0.642392, -0.904031, 0.258559, 0.366852, -0.0835379, 0.284588, 0.360094, -0.0766718, 0.178412, 0.646044, -0.896762, 0.247482, 0.345925, -0.0574872, 0.305001, 0.343363, -0.0700078, -0.397728, 0.321183, -0.324052, -0.284588, 0.603481, -0.870913, -0.288228, 0.597105, -0.876769, -0.280395, 0.614053, -0.900396, -0.265679, 0.628005, -1.45069, -0.344165, 0.336224, -0.09727, -0.36434, 0.34696, -0.201876, -0.25935, 0.612364, -1.54156, -0.234111, 0.637106, -1.50683, -0.297168, 0.420859, -2.02926, -0.310065, 0.418352, -2.02926, -0.213698, 0.634926, -1.53046, -0.191624, 0.425164, -2.03087, -0.0697032, 0.352355, -0.0273979, -0.190042, 0.348486, -0.0451689, -0.312913, 0.339821, -0.0700078, -0.319954, 0.334644, -0.0710175, -0.327075, 0.327014, -0.0722291, -0.339259, 0.333281, -0.0849515, 0.255869, 0.361184, -0.0704117, 0.19835, 0.363418, -0.0580931, 0.0706526, 0.368214, -0.0403223, 2.98023e-08, 0.370449, -0.0364852, -0.0707317, 0.368214, -0.0403223, 0.106968, 0.652965, -1.48563, 0.110528, 0.657052, -1.4517, -0.0958914, 0.640866, -1.53854, -0.101509, 0.647297, -1.51208, -0.107047, 0.652965, -1.48563, 2.98023e-08, 0.6546, -1.48563, 0.110528, 0.661194, -1.26248, 0.172557, 0.658851, -1.24128, 0.210217, 0.654436, -1.26248, 0.210059, 0.654872, -1.24128, 0.210692, 0.654109, -1.21018, 0.215914, 0.647515, -0.951286, 0.20104, 0.369086, -0.0712194, 0.172557, 0.651439, -0.951286, 0.110528, 0.649096, -0.892521, 0.0757953, 0.374373, -0.0534484, -0.364261, 0.37628, -0.322234, -0.342503, 0.378242, -0.199655, -0.275015, 0.620375, -0.89454, -0.275648, 0.622937, -0.922408, -0.2656, 0.62855, -1.43575, -0.254365, 0.638414, -1.4517, -0.329211, 0.359876, -0.0958564, -0.336727, 0.34805, -0.0966642, -0.353421, 0.362601, -0.200665, -0.240045, 0.640648, -1.48563, -0.219949, 0.640376, -1.50804, -0.196767, 0.636507, -1.53268, -0.15792, 0.639286, -1.53551, -0.202305, 0.642501, -1.50905, -0.198429, 0.363418, -0.0580931, -0.255948, 0.361184, -0.0704117, -0.284668, 0.360094, -0.0766718, -0.313467, 0.35895, -0.0829321, -0.247561, 0.345925, -0.0574872, -0.30508, 0.343363, -0.0700078, -0.323515, 0.352464, -0.0825282, 2.98023e-08, 0.376116, -0.0496116, -0.0758744, 0.374373, -0.0534484, 2.98023e-08, 0.658306, -1.4517, -0.163854, 0.645117, -1.51067, -0.169788, 0.650349, -1.48563, -0.110607, 0.657052, -1.4517, 2.98023e-08, 0.662883, -1.24128, 0.110528, 0.66163, -1.24128, 0.110528, 0.660867, -1.21018, 0.110528, 0.654273, -0.951286, 2.98023e-08, 0.650349, -0.88929, -0.262514, 0.62261, -0.879394, -0.259666, 0.626751, -0.889693, -0.253258, 0.636071, -0.913119, -0.264809, 0.630457, -0.919783, -0.258954, 0.635635, -0.951286, -0.270268, 0.627678, -0.951286, -0.264413, 0.634981, -1.23986, -0.265521, 0.62904, -1.4206, -0.264492, 0.634327, -1.26248, -0.254286, 0.638741, -1.43655, -0.242656, 0.644681, -1.42161, -0.242814, 0.644027, -1.4517, -0.316078, 0.364672, -0.0960584, -0.226199, 0.643973, -1.48563, -0.207923, 0.646916, -1.48563, -0.201119, 0.369086, -0.0712194, -0.258638, 0.366852, -0.0835379, -0.110607, 0.649096, -0.892521, -0.178491, 0.646044, -0.896762, -0.110607, 0.661194, -1.26248, -0.172636, 0.654273, -1.4517, -0.110607, 0.66163, -1.24128, -0.110607, 0.660867, -1.21018, -0.110607, 0.654273, -0.951286, 2.98023e-08, 0.655472, -0.951286, -0.238858, 0.639286, -0.908272, -0.247403, 0.641248, -0.951286, -0.241548, 0.648605, -1.24128, -0.25302, 0.642992, -1.24128, -0.228256, 0.647897, -1.42161, -0.228414, 0.647243, -1.4517, -0.221927, 0.642392, -0.904031, -0.211483, 0.650294, -1.4517, -0.172636, 0.651439, -0.951286, -0.215993, 0.647515, -0.951286, -0.172636, 0.658851, -1.24128, -0.211167, 0.651439, -1.40061, -0.233003, 0.644463, -0.951286, -0.227069, 0.65182, -1.24128, -0.210771, 0.654109, -1.21018, -0.210296, 0.654436, -1.26248, -0.210138, 0.654872, -1.24128)

[node name="CarE30" instance=ExtResource("1_0unmn")]
center_of_mass = Vector3(0, 0.16, -0.05)
weight = 1200.0
physics_sub_steps = 1

[node name="DrivetrainController" parent="Components" index="2"]
torque_curve = SubResource("Curve_0unmn")
engine_inertia = 0.35
engine_brake_torque = 40.0
engine_friction_coefficient = 0.007
engine_max_rpm = 6500.0
gear_ratios = Array[float]([-3.83, 0.0, 3.83, 2.2, 1.4, 1.0, 0.81])
upshift_rpm = 6200.0
shift_delay = 0.2
clutch_torque_capacity = 300.0
static_friction_multiplier = 1.2
clutch_heat_capacity = 700.0
clutch_cooling_rate = 0.5
fade_start_temperature = 280.0
fade_complete_temperature = 420.0
auto_clutch_enabled = true

[node name="AeroController" parent="Components" index="3"]
frontal_area = 1.86
drag_coefficient = 0.38
lift_coefficient = 0.15
yaw_stability_factor = 0.02

[node name="ECUController" parent="Components" index="4"]
rev_limit_rpm = 6500.0
rev_resume_rpm = 6100.0

[node name="FrontAxle" parent="Axles" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1.285)
z_offset = -1.285
track_width = 1.42
spring_stiffness = 18500.0
spring_bump_damping = 1500.0
spring_rebound_damping = 3750.0
anti_roll_stiffness = 25000.0
camber_angle_deg = -0.7
caster_angle_deg = 8.5
tire_model = SubResource("Resource_fu083")

[node name="WheelFL" parent="Axles/FrontAxle" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.71, 0, 0)

[node name="WheelFR" parent="Axles/FrontAxle" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.71, 0, 0)

[node name="RearAxle" parent="Axles" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1.285)
z_offset = 1.285
track_width = 1.416
diff_ratio = 3.73
max_spring_length = 0.2
spring_stiffness = 43000.0
spring_bump_damping = 2400.0
anti_roll_stiffness = 8500.0
camber_angle_deg = -2.0
toe_angle_deg = 0.2
lsd_power_lock_factor = 0.35
differential_lock_capacity = 1200.0
tire_model = SubResource("Resource_m4qmp")

[node name="WheelRL" parent="Axles/RearAxle" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.708, 0, 0)

[node name="WheelRR" parent="Axles/RearAxle" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.708, 0, 0)

[node name="AeroCenterPoint" parent="." index="3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.15, 0.253)

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="4"]
transform = Transform3D(-2.085, 0, 3.14826e-07, 0, 2.085, 0, -3.14826e-07, 0, -2.085, 0, -0.366475, -2.05308)
shape = SubResource("ConvexPolygonShape3D_fu083")

[node name="e30" parent="." index="5" instance=ExtResource("3_fu083")]
transform = Transform3D(-2.085, 0, 3.14826e-07, 0, 2.085, 0, -3.14826e-07, 0, -2.085, 0, -0.366475, -2.05308)
visible = false

[editable path="Axles/FrontAxle/WheelFL"]
[editable path="Axles/FrontAxle/WheelFR"]
[editable path="Axles/RearAxle/WheelRL"]
[editable path="Axles/RearAxle/WheelRR"]
[editable path="e30"]
